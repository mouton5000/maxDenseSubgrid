\section{An instance with an $O(\sqrt{n})$ gap between the worst and the best solution.}

\label{apx:badinstance}


In \cite{WP16}, Theorem~2 of Section~4 proves a default $2\sqrt{n}$ upper bound of the approximation ratio for every algorithm returning a maximal solution.

We give, in this appendix, in Figure~\ref{fig:badExample}, an instance in which the ratio between an optimal density and the lowest density of a maximal solution is $O(\sqrt{n})$. This instance contains a square of $r \times r$ blue ones (in Figure~\ref{fig:badExample}, $r = 4$) and two diagonal lines of $r$ red ones and $r$ green ones. Note that, as $r$ approaches infinity, $r^2$ is asymptotically equivalent to $n$. An optimal solution, given in Figure~\ref{fig:badexampleGood}, consists in maximally contracting the blue square. In that case, most of the blue ones have 8 neighbors (the maximum number of neighbors an entry can have in the matrix). The density of this matrix is $O(r^2) = O(n)$. On the contrary, an algorithm which contracts the lines containing the green ones and the columns containing the red ones would obtain the matrix in Figure~\ref{fig:badExampleBad}. In this matrix, no line or column can be contracted and most of the blue ones have no neighbor. The density is $O(r) = O(\sqrt{n})$. 

\input{approx_bad_instance}
\input{approx_bad_instance_good}
\input{approx_bad_instance_bad}



Note that this is not a hard instance for the greedy algorithm, the neighborization algorithm or the LCL algorithm as the density of the resulting matrix of each algorithm is $O(n)$. Indeed, the greedy algorithm and the neighborization contract the blue square first. The LCL algorithm either contracts all the lines of the matrix or contracts all the columns: every blue one has at least one neighbor and the density is $O(r^2)$. However, for each algorithm, we can adapt this instance such that the density returned by this algorithm is $O(\sqrt{n})$. Each of the following subsections is dedicated to an algorithm and its adapted instance. 

\subsection{Adaptation to the greedy algorithm}

In Figure~\ref{fig:greedyExample}, we give an instance adapted from the instance of Figure~\ref{fig:badExample}. This instance contains, from coordinates (1,1) to (11,11), is the square of $r \times r$ blue 1 (in Figure~\ref{fig:greedyExample}, $r = 6$). It also contains $8$ sets of $r$ green ones and $r-1$ sets of $3$ red ones. Note that, as $r$ approaches infinity, $r^2$ is asymptotically equivalent to $n$. An optimal solution is obtained by fully contracting this square. To do so, we have to contract lines and columns 2, 4, 6, 8 and 10 (the blue lines and columns). In that case, most of the blue ones have 8 neighbors (the maximum number of neighbors an entry can have in the matrix). The density of this matrix is $O(r^2) = O(n)$. This is illustrated with Figure~\ref{fig:greedyExampleGood}. The worst maximal solution is obtained by not contracting the square. We can increase the density of the matrix by contracting lines 13 and 17 and by contracting columns 13 and 17 (the green lines and columns). However, due to the red 1, it is not allowed to contract all the green lines and columns \textbf{and} all the blue lines and columns. A consequence is that we can either contract all the green 1 or contract all the blue 1 (or a part of each). Finally, note that it in not allowed to contract any other line or column.

What columns or lines does the greedy algorithm contract in this instance? The algorithm searches for the line or the column such that the contraction of that line or column maximally increases the density of the matrix. It appears that contracting any green line or column increases the density by $3 * r - 1$ and that contracting any blue line or column increases the density by $r+1$. Thus, the greedy algorithm chooses one of the green lines or columns and starts again. The same phenomenon occurs in the resulting matrix : an increase of $r+1$ with the blue lines and columns and an increase of $3 * r - 1$ with the left green lines and columns. The algorithm then always chooses a green line or column until the solution is maximal. The returned solution is given in Figure~\ref{fig:greedyExampleBad}. Its density is $O(12r) = O(\sqrt{n})$. 



\renewcommand{\gridsize}{0.5}
\input{approx_bad_instanceGreedy}
\input{approx_bad_instanceGreedy_good}
\input{approx_bad_instanceGreedy_bad}

\subsection{Adaptation to the neighborization algorithm}

In Figure~\ref{fig:neighborizationExample}, we give an instance adapted from the instance of Figure~\ref{fig:badExample}. This instance contains, from coordinates (1,1) to (11,11), a square of $r \times r$ blue 1 (in Figure~\ref{fig:greedyExample}, $r = 6$). It also contains $8$ sets of $r+2$ green ones and $r-1$ sets of $3$ red ones. Note that, as $r$ approaches infinity, $r^2$ is asymptotically equivalent to $n$. An optimal solution is obtained by fully contracting this square. To do so, we have to contract lines and columns 2, 4, 6, 8 and 10 (the blue lines and columns). In that case, most of the blue ones have 8 neighbors (the maximum number of neighbors an entry can have in the matrix). The density of this matrix is $O(r^2) = O(n)$. This is illustrated with Figure~\ref{fig:neighborizationExampleGood}. The worst maximal solution is obtained by not contracting it.  We can increase the density of the matrix by contracting lines 13,14,15 and 19,20 and by contracting columns 13,14,15 and 19,20 (the green lines and columns). However, due to the red 1, it is not allowed to contract all the green lines and columns \textbf{and} all the blue lines and columns. A consequence is that we can either contract all the green 1 or contract all the blue 1 (or a part of each). Finally, note that it in not allowed to contract any other line or column.

What columns or lines does the neighborization algorithm contract in this instance? The algorithm searches for the line or the column such that the contraction of that line or column minimally decreases the number of pairs of 1 that can become neighbors. It appears that contracting any green line or column decreases this number by at most $3r$. On the other hand, contracting a blue line or column decreases this number by $3r + 2$. Thus, the neighborization algorithm chooses one of the green lines or columns and starts again. The same phenomenon occurs in the resulting matrix : a decrease of $3r + 2$ with the blue lines and columns and a decrease of at most $3r$ with the left green lines and columns. The algorithm then always choose a green line or column until the solution is maximal. The returned solution is given in Figure~\ref{fig:neighborizationExampleBad}. Its density is $O(12r) = O(\sqrt{n})$. 


\renewcommand{\gridsize}{0.5}
\input{approx_bad_instanceNeigh}
\input{approx_bad_instanceNeigh_good}
\input{approx_bad_instanceNeigh_bad}

\subsection{Adaptation to the LCL algorithm}
\renewcommand{\gridsize}{0.35}

In Figure~\ref{fig:lclExample}, we give an instance adapted from the instance of Figure~\ref{fig:badExample}. This instance contains, from coordinates (1,1) to (22,22),  a square of $r \times r$ black 1 (in Figure~\ref{fig:lclExample}, $r = 4$). It also contains $2 \cdot (r-1)$ sets of $4$ colored ones. Note that, as $r$ approaches infinity, $r^2$ is asymptotically equivalent to $n$. An optimal solution is obtained by fully contracting this square. To do so, we have to contract lines and columns 1 to 21 except 5,11 and 17. In that case, most of the black ones of the square have 8 neighbors (the maximum number of neighbors an entry can have in the matrix). The density of this matrix is $O(r^2) = O(n)$. This is illustrated with Figure~\ref{fig:lclExampleGood}. The worst maximal solution is obtained by not contracting it. 

What columns or lines does the LCL algorithm contract in this instance? The algorithm computes two maximal feasible solutions : the LC solution, in which we first contract a maximal set of lines and then contract a maximal set of columns; and the CL solution, in which we start with the columns and end with the lines. A problem appears in the instance of Figure~\ref{fig:lclExample} due to the green, blue and red groups. For instance, there are two 1 at coordinates (1,35) and (6,35). Consequently, it is not allowed to contract lines 1,2,3,4 and 5: the algorithm must choose which line not to contract. The same phenomenon occurs for every pair of colored 1 that are on the same line or on the same column. If the algorithm chooses not to contract the columns and lines 4,6,10,12,16 and 18, the LC solution and the CL solution are the same and the algorithm returns the matrix given in Figure~\ref{fig:lclExampleBad}. Its density is $O(r) = O\sqrt{n})$.

\begin{remark}
	Currently, the way the algorithm chooses which line of column not to contract is not specified. Note that if the LCL algorithm always choose the first line or the first column that can be contracted, it returns an optimal solution on the instance of Figure~\ref{fig:lclExample}. It is not know if there is an instance in which that algorithm returns $O(\sqrt{n})$ times an optimal density. 
\end{remark}

\input{approx_bad_instanceLCL}
\input{approx_bad_instanceLCL_good}
\input{approx_bad_instanceLCL_bad}

\section{Discussion}

We highly believe the instance given in Figure~\ref{fig:badExample} is the worst case that can happen and that the density of a maximal solution is always higher than $4\sqrt{n}$. The result of Theorem~2 in \cite{WP16} may then possibly be updated to the following conjecture. 

\begin{conjecture}
	An algorithm returning any maximal solution of an instance of (MMC) is a $\sqrt{n}$-approximation.
\end{conjecture}